<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aegis - Multi-Organization Alert Exchange</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>Aegis</h1>
            <p class="subtitle">Privacy-Preserving Alert Exchange System</p>
        </header>

        <!-- Navigation Tabs -->
        <nav class="tabs">
            <button class="tab-btn active" data-tab="register">Register Organization</button>
            <button class="tab-btn" data-tab="login">Get Token</button>
            <button class="tab-btn" data-tab="submit">Submit Alert</button>
            <button class="tab-btn" data-tab="search">Search Alerts</button>
            <button class="tab-btn" data-tab="aggregate">Aggregate Data</button>
            <button class="tab-btn" data-tab="orgs">Organizations</button>
        </nav>

        <!-- Main Content Area -->
        <main class="content">
            <!-- Register Organization Tab -->
            <section id="register-tab" class="tab-content active">
                <h2>Register New Organization</h2>
                <form id="register-form" class="form">
                    <div class="form-group">
                        <label for="reg-org-id">Organization ID</label>
                        <input type="text" id="reg-org-id" placeholder="e.g., org1" required>
                        <small>Unique identifier for your organization</small>
                    </div>
                    <div class="form-group">
                        <label for="reg-org-name">Organization Name</label>
                        <input type="text" id="reg-org-name" placeholder="e.g., Alpha Security Corp" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-org-email">Contact Email (Optional)</label>
                        <input type="email" id="reg-org-email" placeholder="contact@example.com">
                    </div>
                    <button type="submit" class="btn btn-primary">Register Organization</button>
                </form>
                <div id="register-result" class="result"></div>
            </section>

            <!-- Get Token Tab -->
            <section id="login-tab" class="tab-content">
                <h2>Get API Token</h2>
                <form id="login-form" class="form">
                    <div class="form-group">
                        <label for="login-org-id">Organization ID</label>
                        <input type="text" id="login-org-id" placeholder="e.g., org1" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Get Token</button>
                </form>
                <div id="login-result" class="result"></div>
                <div class="info-box" id="token-info" style="display: none;">
                    <h3>Current Session</h3>
                    <p><strong>Organization:</strong> <span id="current-org-name"></span></p>
                    <p><strong>Org ID:</strong> <span id="current-org-id"></span></p>
                    <p><strong>Token:</strong> <code id="current-token"></code></p>
                </div>
            </section>

            <!-- Submit Alert Tab -->
            <section id="submit-tab" class="tab-content">
                <h2>Submit Alert</h2>
                <div class="auth-required" id="submit-auth-warning">
                    <p>Please get an API token first from the "Get Token" tab.</p>
                </div>
                <form id="submit-form" class="form" style="display: none;">
                    <div class="form-group">
                        <label for="alert-type">Alert Type</label>
                        <select id="alert-type" required>
                            <option value="">Select type...</option>
                            <option value="malware">Malware</option>
                            <option value="phishing">Phishing</option>
                            <option value="ddos">DDoS</option>
                            <option value="ransomware">Ransomware</option>
                            <option value="data_breach">Data Breach</option>
                            <option value="intrusion">Intrusion</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="alert-severity">Severity</label>
                        <select id="alert-severity" required>
                            <option value="">Select severity...</option>
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                            <option value="critical">Critical</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="alert-source">Source</label>
                        <input type="text" id="alert-source" placeholder="e.g., endpoint, network, email" required>
                    </div>
                    <div class="form-group">
                        <label for="alert-risk-score">Risk Score (0-100)</label>
                        <input type="number" id="alert-risk-score" min="0" max="100" placeholder="e.g., 75" required>
                        <small>Will be encrypted using Paillier homomorphic encryption</small>
                    </div>
                    <div class="form-group">
                        <label for="alert-description">Description (Optional)</label>
                        <textarea id="alert-description" rows="3" placeholder="Additional details..."></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Alert</button>
                </form>
                <div id="submit-result" class="result"></div>
            </section>

            <!-- Search Alerts Tab -->
            <section id="search-tab" class="tab-content">
                <h2>Search Alerts</h2>
                <div class="auth-required" id="search-auth-warning">
                    <p>Please get an API token first from the "Get Token" tab.</p>
                </div>
                <form id="search-form" class="form" style="display: none;">
                    <div class="form-group">
                        <label for="search-type">Alert Type</label>
                        <select id="search-type" required>
                            <option value="">Select type to search...</option>
                            <option value="malware">Malware</option>
                            <option value="phishing">Phishing</option>
                            <option value="ddos">DDoS</option>
                            <option value="ransomware">Ransomware</option>
                            <option value="data_breach">Data Breach</option>
                            <option value="intrusion">Intrusion</option>
                        </select>
                        <small>Uses HMAC-based privacy-preserving search</small>
                    </div>
                    <button type="submit" class="btn btn-primary">Search</button>
                </form>
                <div id="search-result" class="result"></div>
            </section>

            <!-- Aggregate Data Tab -->
            <section id="aggregate-tab" class="tab-content">
                <h2>Aggregate Risk Scores</h2>
                <div class="auth-required" id="aggregate-auth-warning">
                    <p>Please get an API token first from the "Get Token" tab.</p>
                </div>
                <div id="aggregate-controls" style="display: none;">
                    <p class="info-text">
                        Compute homomorphic aggregates on encrypted risk scores from all organizations.
                        Results remain encrypted and can only be decrypted by authorized parties.
                    </p>
                    <button id="aggregate-btn" class="btn btn-primary">Compute Aggregates</button>
                </div>
                <div id="aggregate-result" class="result"></div>
            </section>

            <!-- Organizations Tab -->
            <section id="orgs-tab" class="tab-content">
                <h2>Organizations</h2>
                <div class="tab-controls">
                    <button id="list-orgs-btn" class="btn btn-secondary">List All Organizations</button>
                    <button id="my-info-btn" class="btn btn-secondary" style="display: none;">My Organization Info</button>
                    <button id="my-alerts-btn" class="btn btn-secondary" style="display: none;">My Submitted Alerts</button>
                </div>
                <div id="orgs-result" class="result"></div>
            </section>
        </main>

        <!-- Status Bar -->
        <footer class="status-bar">
            <div id="status-message">Ready</div>
            <div id="api-status">
                <span class="status-indicator" id="api-indicator"></span>
                <span id="api-text">API: Disconnected</span>
            </div>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>